<%- include('partials/header.ejs'); %> <h1>node5-1 Hello page3 Page</h1> MySQL ユーザメンテナンス（非同期通信）<br>
<label for="id">ID</label>
<input id="id" type="text"><br>
<label for="username">username</label>
<input id="username" type="text"><br>
<label for="email">email</label>
<input id="email" type="text"><br>
<label for="password">password</label>
<input id="password" type="text"><br>
<input id="getbutton" type="submit" value="一覧取得（GET）">
<input id="postbutton" type="submit" value="登録（POST）">
<input id="putbutton" type="submit" value="変更（PUT）">
<input id="deletebutton" type="submit" value="削除（DELETE）">
<hr>
<div id="output"></div>
<hr>
<script>
  $('#getbutton').click((e) => {
    $.ajax({
      type: 'GET',
      data: val,
      dataType: 'json',
      url: '/mysql',
    }).done((results) => {
      console.log(typeof results)
      console.log(results)
      $('#output').append('GET:' + results.name + '<br>')
    }).fail((xhr, status, err) => {
      console.log('通信に失敗しました')
    }).always((xhr) => { })
  })

  $('#postbutton').click((e) => {
    const val = {
      id: $('#id').val(),
      username: $('#username').val(),
      email: $('#email').val(),
      password: $('#password').val()
    }
    $.ajax({
      type: 'POST',
      data: val,
      dataType: 'json',
      url: '/mysql',
    }).done((results) => {
      console.log(typeof results)
      console.log(results)
      $('#output').append('POST:' + results.msg + results.id + results.username + results.email + results.password + '<br>')

    }).fail((xhr, status, err) => {
      console.log('通信に失敗しました')
    }).always((xhr) => {
    })
  })

  $('#putbutton').click((e) => {
    const val = {
      id: $('#id').val(),
      username: $('#username').val(),
      email: $('#email').val(),
      password: $('#password').val()
    }
    $.ajax({
      type: 'PUT',
      data: val,
      dataType: 'json',
      url: '/mysql',
    }).done((results) => {
      console.log(typeof results)
      console.log(results)
      $('#output').append('PUT:' + results.name + '<br>')
    }).fail((xhr, status, err) => {
      console.log('通信に失敗しました')
    }).always((xhr) => {
    })
  })
  $('#deletebutton').click((e) => {
    const val = {
      id: $('#id').val(),
      username: $('#username').val(),
      email: $('#email').val(),
      password: $('#password').val()
    }
    $.ajax({
      type: 'DELETE',
      data: val,
      dataType: 'json',
      url: '/mysql',
    }).done((results) => {
      console.log(typeof results)
      console.log(results)
      $('#output').append('DELETE:' + results.name + '<br>')

    }).fail((xhr, status, err) => {
      console.log('通信に失敗しました')
    }).always((xhr) => {
    })
  })
</script>
<img src="/img/image1.jpg"><br />
<img src="/img/image2.png"> <%- include('partials/footer.ejs'); %>
