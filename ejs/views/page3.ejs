<%- include('partials/header.ejs'); %> <h1>node4-5 Hello page3 Page</h1> ユーザメンテナンス（非同期通信）<br>
<input id="textvalue" type="text"><br>
<input id="getbutton" type="submit" value="取得（GET）">
<input id="postbutton" type="submit" value="登録（POST）">
<input id="putbutton" type="submit" value="変更（PUT）">
<input id="deletebutton" type="submit" value="削除（DELETE）">
<hr>
<div id="output"></div>
<hr>
<script>
  $('#getbutton').click((e) => {
    const val = {
      name: $('#textvalue').val()
    }
    $.ajax({
      type: 'GET',
      data: val,
      dataType: 'json',
      url: '/users',
    }).done((results) => {
      console.log(typeof results)
      console.log(results)
      $('#output').append('GET:' + results.name + '<br>')
    }).fail((xhr, status, err) => {
      console.log('通信に失敗しました')
    }).always((xhr) => { })
  })

  $('#postbutton').click((e) => {
    const val = {
      name: $('#textvalue').val()
    }
    console.log('post:' + val.name)
    $.ajax({
      type: 'POST',
      data: val,
      dataType: 'json',
      url: '/users',
    }).done((results) => {
      console.log(typeof results)
      console.log(results)
      $('#output').append('POST:' + results.name + '<br>')
    }).fail((xhr, status, err) => {
      console.log('通信に失敗しました')
    }).always((xhr) => {
    })
  })

  $('#putbutton').click((e) => {
    const val = {
      name: $('#textvalue').val()
    }
    $.ajax({
      type: 'PUT',
      data: val,
      dataType: 'json',
      url: '/users',
    }).done((results) => {
      console.log(typeof results)
      console.log(results)
      $('#output').append('PUT:' + results.name + '<br>')
    }).fail((xhr, status, err) => {
      console.log('通信に失敗しました')
    }).always((xhr) => {
    })
  })
  $('#deletebutton').click((e) => {
    const val = {
      name: $('#textvalue').val()
    }
    $.ajax({
      type: 'DELETE',
      data: val,
      dataType: 'json',
      url: '/users',
    }).done((results) => {
      console.log(typeof results)
      console.log(results)
      $('#output').append('DELETE:' + results.name + '<br>')
    }).fail((xhr, status, err) => {
      console.log('通信に失敗しました')
    }).always((xhr) => {
    })
  })
</script>
<img src="/img/image1.jpg"><br />
<img src="/img/image2.png"> <%- include('partials/footer.ejs'); %>
